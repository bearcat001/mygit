<?php

	class M_blog extends CI_Model{
		private $blog_table;
		private $blog_category_table;
		private $blog_tag_table;
		
		/**
		 * 构造函数 
		 */
		function __construct(){
			parent::__construct();
			$this->blog_table=$this->db->dbprefix('blog_table');
			$this->blog_category_table=$this->db->dbprefix('blog_category_table');
			$this->blog_tag_table=$this->db->dbprefix('blog_tag_table');
			$this->create_table();
		}
		
		/**
		 * 创建数据库
		 * @return unknown
		 */
		function create_table(){
			$result= $this->db->simple_query("
					CREATE TABLE IF NOT EXISTS {$this->blog_table} (
					  `blog_id` int(11) unsigned NOT NULL AUTO_INCREMENT,
					  `user_id` int(11) unsigned NOT NULL,
					  `create_time` int(10) unsigned NOT NULL,
					  `blog_title` varchar(200) NOT NULL,
					  `blog_content` text NOT NULL,
					  `blog_category` int(11) unsigned NOT NULL,
					  `transpond_id` int(11) unsigned NOT NULL,
					  `transpond_count` int(11) unsigned NOT NULL,
					  `comment_count` int(11) unsigned NOT NULL,
					  `blog_type` int(2) unsigned NOT NULL,
					  `blog_visible` int(11) unsigned NOT NULL,
					  `blog_password` varchar(49) NOT NULL,
					  PRIMARY KEY (`blog_id`)
					) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
					");
			$result2=$this->db->simple_query("
					CREATE TABLE IF NOT EXISTS {$this->blog_category_table} (
					  `blog_category_id` int(11) unsigned NOT NULL AUTO_INCREMENT,
					  `blog_category_name` varchar(200) NOT NULL,
					  `blog_count` int(11) unsigned NOT NULL,
					  PRIMARY KEY (`blog_category_id`)
					) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;
					");
			$result3=$this->db->simple_query("
					CREATE TABLE IF NOT EXISTS {$this->blog_tag_table} (
					  `blog_tag_id` int(11) unsigned NOT NULL,
					  `blog_tag_name` varchar(200) NOT NULL,
					  `blog_id` int(11) unsigned NOT NULL,
					  PRIMARY KEY (`blog_tag_id`)
					) ENGINE=MyISAM DEFAULT CHARSET=utf8;
					");
			return $result;
		}
		
		/**
		 * 添加一个用户
		 * @param array $data
		 * @return string|Ambigous <string, boolean>
		 */
		function add_blog($data){
			$this->db->insert($this->blog_table,$data);
			return ($this->db->affected_rows() > 0) ? $this->db->insert_id() : FALSE;
		}

	
	}
?>
		
		